//Hidden Gems (Rating Tinggi tapi Kurang Dikenal)
MATCH (b:Book)
WHERE b.avg_rating >= 4.3 
  AND b.ratings_count < 5000 
  AND b.ratings_count > 100
RETURN b.title AS Judul,
       b.avg_rating AS Rating,
       b.ratings_count AS JumlahRating,
       b.popularity AS Popularitas
ORDER BY b.avg_rating DESC
LIMIT 15;

//Penulis dengan Rating Konsisten Tinggi
MATCH (b:Book)-[:WRITTEN_BY]->(a:Author)
WITH a, 
     AVG(b.avg_rating) AS AvgRating,
     MIN(b.avg_rating) AS MinRating,
     MAX(b.avg_rating) AS MaxRating,
     COUNT(b) AS TotalBuku
WHERE TotalBuku >= 3 AND MinRating >= 4.0
RETURN a.name AS Penulis,
       ROUND(AvgRating, 2) AS RataRating,
       ROUND(MinRating, 2) AS RatingTerendah,
       ROUND(MaxRating, 2) AS RatingTertinggi,
       TotalBuku
ORDER BY AvgRating DESC
LIMIT 10;

//Publisher mana yang menerbitkan buku paling populer?
MATCH (b:Book)-[:PUBLISHED_BY]->(p:Publisher)
WITH p, 
     COUNT(b) AS TotalBuku,
     AVG(b.avg_rating) AS RataRating,
     SUM(b.ratings_count) AS TotalRatings
RETURN p.name AS Publisher,
       TotalBuku,
       ROUND(RataRating, 2) AS AvgRating,
       TotalRatings
ORDER BY TotalRatings DESC
LIMIT 10;

//Buku Paling Controversial (Banyak Review tapi Rating Biasa)
MATCH (b:Book)
WHERE b.reviews_count > 1000
WITH b, 
     (b.reviews_count * 1.0 / b.ratings_count) AS ReviewRatio
WHERE ReviewRatio > 0.1
RETURN b.title AS Judul,
       b.avg_rating AS Rating,
       b.reviews_count AS JumlahReview,
       b.ratings_count AS JumlahRating,
       ROUND(ReviewRatio, 3) AS RatioReview
ORDER BY ReviewRatio DESC
LIMIT 10;
